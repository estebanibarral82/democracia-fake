(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const r={mentira:[{year:"1973",title:"Plan Z: la UP planea masacrar a 5 000 opositores",description:"La prensa oficial reproduce un supuesto documento militar que atribuye al gobierno de Allende un plan de autogolpe para el 19 de septiembre, con listas de enemigos y croquis de cuarteles intervenidos.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"1975",title:"Exterminados como ratones: el MIR se depura con 119 muertos",description:"El diario La Segunda afirma que los militantes desaparecidos murieron en peleas internas en el extranjero, basándose en revistas que nadie ha logrado encontrar en los países mencionados.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2017",title:"Chats de WhatsApp prueban red terrorista mapuche",description:"Capturas de pantalla presentadas por Carabineros se emiten en noticieros como prueba irrefutable de coordinación de ataques. Ocho comuneros son detenidos en horario estelar.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2018",title:"Comunero armado cae en enfrentamiento con GOPE",description:"La versión oficial acusa a Camilo Catrillanca de participar en un robo y disparar contra el GOPE. Se afirma que no hay registro audiovisual del operativo.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2020",title:"Detenido con bidón de bencina es el autor de incendio en Metro Baquedano",description:"Imágenes de un joven reducido por Carabineros se viralizan como prueba del ataque. Medios lo presentan como un manifestante violento sorprendido con acelerantes.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2021",title:"Fans de K-pop organizan atentados y saqueos durante protestas",description:"En redes sociales y noticieros se acusa a comunidades K-pop de usar sus plataformas para coordinar hechos de violencia durante el estallido social.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"}],verdad:[{year:"1973",title:"Militares difunden plan sin respaldo documental ni fuentes verificables",description:"La Junta informa de un plan atribuido a la UP, pero no exhibe originales ni autores. Partidos opositores y medios extranjeros no encuentran pruebas que sustenten su existencia.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"1975",title:"Detenidos desaparecidos por razones políticas son eliminados por la DINA",description:"Organismos de derechos humanos documentan desapariciones sistemáticas de opositores. La justicia confirma que fueron víctimas del aparato represivo de la dictadura.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2017",title:"Carabineros produce montaje con capturas falsas",description:"La justicia determina que las imágenes fueron manipuladas digitalmente. Los ocho comuneros detenidos son liberados sin cargos tras demostrarse la adulteración.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2018",title:"Camilo Catrillanca muere por disparo de Carabineros sin estar armado",description:"Peritajes balísticos y testigos confirman que el comunero murió por un disparo del GOPE. No participaba en ningún robo y no portaba armas. Videos del operativo fueron destruidos.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2020",title:"Joven es detenido arbitrariamente; incendio tiene otro origen",description:"Investigaciones posteriores demuestran que el incendio tuvo causas técnicas no relacionadas con el detenido. El joven es liberado sin cargos tras comprobarse su inocencia.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2021",title:"Fans de K-pop apoyan causas pacíficas y derechos humanos",description:"La comunidad K-pop chilena demuestra su compromiso con la no violencia y el apoyo a manifestaciones pacíficas por la justicia social.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"}]};class u{constructor(){this.currentMode="mentira",this.currentModalYear=null,this.currentModalMode="mentira",this.init()}init(){console.log("Initializing DemocraciaFake app..."),this.setupEventListeners(),this.renderTimeline(),this.initScrollAnimations(),this.updateLogo(),this.initSwitchLabels(),this.initScrollProgress(),this.initFloatingSwitch(),this.initDecadesTimeline(),this.initModalFunctionality(),window.testSwitch=e=>{console.log("Manual switch test:",e),this.toggleMode(e)},console.log("DemocraciaFake app initialized successfully"),console.log("Use window.testSwitch(true/false) to test switches manually")}initSwitchLabels(){console.log("Initializing switch labels...");const e=document.querySelector(".switch-label.left"),n=document.querySelector(".switch-label.right");console.log("Main switch labels found:",e,n),e&&n&&(e.classList.add("active"),n.classList.remove("active"));const t=document.querySelector(".floating-switch-label.left"),o=document.querySelector(".floating-switch-label.right");console.log("Floating switch labels found:",t,o),t&&o&&(t.classList.add("active"),o.classList.remove("active"))}setupEventListeners(){console.log("Setting up event listeners..."),document.addEventListener("change",a=>{console.log("Change event detected:",a.target.id,a.target.checked),a.target.id==="switchInput"?(console.log("Main switch changed via delegation:",a.target.checked),a.stopPropagation(),this.toggleMode(a.target.checked)):a.target.id==="floatingSwitchInput"?(console.log("Floating switch changed via delegation:",a.target.checked),a.stopPropagation(),this.toggleMode(a.target.checked)):a.target.id==="modalSwitchInput"&&(console.log("Modal switch changed via delegation:",a.target.checked),a.stopPropagation(),this.currentModalMode=a.target.checked?"verdad":"mentira",this.updateModalContent(),this.updateModalSwitchLabels())});const e=document.getElementById("switchInput"),n=document.getElementById("floatingSwitchInput");console.log("Switch elements check:",{mainSwitch:!!e,floatingSwitch:!!n}),document.getElementById("firmaButton")?.addEventListener("click",()=>{alert("Redirigiendo a formulario de suscripción...")}),document.addEventListener("click",a=>{if(a.target.classList.contains("timeline-cta")){a.preventDefault();const c=a.target.closest(".timeline-item").querySelector(".timeline-year").textContent;this.openVideoModal(c)}});const o=document.getElementById("videoModal"),i=document.getElementById("videoModalClose"),s=document.getElementById("videoModalOverlay");i?.addEventListener("click",()=>{this.closeModal()}),s?.addEventListener("click",()=>{this.closeModal()}),o?.addEventListener("click",a=>{a.target===o&&this.closeModal()}),document.addEventListener("keydown",a=>{a.key==="Escape"&&this.closeModal()})}toggleMode(e){console.log("toggleMode called with:",e,"current mode:",this.currentMode);const n=e?"verdad":"mentira";if(this.currentMode===n){console.log("Mode unchanged, skipping update");return}this.currentMode=n,console.log("Mode changed to:",this.currentMode),document.body.classList.toggle("verdad-mode",e);const t=document.getElementById("switchInput"),o=document.getElementById("floatingSwitchInput");t&&t.checked!==e&&(console.log("Syncing main switch to:",e),t.checked=e),o&&o.checked!==e&&(console.log("Syncing floating switch to:",e),o.checked=e),this.updateAllSwitchLabels(e),this.updateLogo(),this.renderTimeline()}updateAllSwitchLabels(e){const n=document.querySelector(".switch-label.left"),t=document.querySelector(".switch-label.right");n&&t&&(n.classList.toggle("active",!e),t.classList.toggle("active",e));const o=document.querySelector(".floating-switch-label.left"),i=document.querySelector(".floating-switch-label.right");o&&i&&(o.classList.toggle("active",!e),i.classList.toggle("active",e))}updateLogo(){const e=document.getElementById("mainLogo");e&&(this.currentMode==="verdad"?(e.src="header-verdad.png",e.alt="Democracia Fake - Verdad"):(e.src="header-mentira.png",e.alt="Democracia Fake - Montaje"))}renderTimeline(){const e=document.getElementById("timeline");if(!e)return;const n=r[this.currentMode];e.innerHTML="",n.forEach((t,o)=>{const i=document.createElement("div");i.className="timeline-item",i.setAttribute("data-year",t.year),i.innerHTML=`
        <div class="timeline-circle ${o===0?"active":""}"></div>
        <div class="timeline-year">${t.year}</div>
        <div class="timeline-content">
          <h3>${t.title}</h3>
          <p>${t.description}</p>
          <button class="timeline-cta">${t.cta}</button>
        </div>
      `,e.appendChild(i)}),this.initScrollAnimations()}initFloatingSwitch(){const e=document.getElementById("floatingSwitchNav");if(!e){console.error("Floating switch nav element not found");return}window.addEventListener("scroll",()=>{const n=window.scrollY,t=document.querySelector(".verdad-mentira-section");if(t){const o=t.offsetTop,i=o+t.offsetHeight,s=window.innerHeight;n>=o-200&&n<=i-s+200?e.classList.add("visible"):e.classList.remove("visible")}})}initDecadesTimeline(){const e=document.querySelector(".decades-items");if(!e)return;const n=[{decade:1970,label:"70s",years:["1973","1975"]},{decade:1980,label:"80s",years:[]},{decade:1990,label:"90s",years:[]},{decade:2e3,label:"00s",years:[]},{decade:2010,label:"10s",years:["2017","2018"]},{decade:2020,label:"20s",years:["2020","2021"]}];e.innerHTML="",n.forEach((t,o)=>{const i=document.createElement("div");i.className="decade-item",i.setAttribute("data-decade",t.decade),t.years.length===0&&i.classList.add("no-content");const s=document.createElement("div");s.className=`decade-circle ${o===0?"active":""}`;const a=document.createElement("div");a.className="decade-label",a.textContent=t.label,i.appendChild(s),i.appendChild(a),t.years.length>0?(i.addEventListener("click",()=>{this.scrollToDecade(t.decade,t.years[0]),document.querySelectorAll(".decade-circle").forEach(c=>c.classList.remove("active")),s.classList.add("active")}),i.style.cursor="pointer"):(i.style.cursor="not-allowed",i.style.opacity="0.5"),e.appendChild(i)}),this.initDecadesTimelineVisibility(),window.addEventListener("scroll",()=>{this.updateDecadesTimeline()})}initDecadesTimelineVisibility(){const e=document.querySelector(".decades-timeline"),n=document.querySelector(".verdad-mentira-section");!e||!n||window.addEventListener("scroll",()=>{const t=n.offsetTop,o=t+n.offsetHeight,i=window.scrollY,s=window.innerHeight;i>=t-100&&i<=o-s+100?e.classList.add("visible"):e.classList.remove("visible")})}scrollToDecade(e,n){const t=document.querySelector(`[data-year="${n}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"center"})}updateDecadesTimeline(){const e=document.querySelectorAll(".decade-item"),n=document.querySelectorAll(".timeline-item"),t=window.innerHeight;let o=null;n.forEach(i=>{const s=i.getBoundingClientRect(),a=parseInt(i.getAttribute("data-year"));s.top<t*.6&&s.bottom>t*.4&&(a>=1970&&a<1980?o=1970:a>=2010&&a<2020?o=2010:a>=2020&&a<2030&&(o=2020))}),e.forEach(i=>{const s=parseInt(i.getAttribute("data-decade")),a=i.querySelector(".decade-circle");s===o?a.classList.add("active"):a.classList.remove("active")})}initModalFunctionality(){const e=document.getElementById("modalSwitchInput");e&&(e.checked=!1)}openVideoModal(e){console.log("Opening video modal for year:",e),this.currentModalYear=e,this.currentModalMode=this.currentMode;const n=document.getElementById("videoModal"),t=document.getElementById("modalSwitchInput");this.updateModalContent(),t?(console.log("Modal switch found, setting checked state"),t.checked=this.currentModalMode==="verdad"):console.error("Modal switch not found"),this.updateModalSwitchLabels(),n&&(n.classList.add("active"),document.body.style.overflow="hidden")}updateModalContent(){const e=this.currentModalYear,n=this.currentModalMode,t=r.mentira.findIndex(a=>a.year===e);if(t===-1)return;const o=r[n][t],i=document.getElementById("modalTitle");i&&(i.textContent=`${e} - ${o.title}`);const s=document.getElementById("modalVideoContainer");s&&o.videoUrl&&(s.innerHTML=`
        <iframe 
          src="${o.videoUrl}" 
          frameborder="0" 
          allowfullscreen>
        </iframe>
      `)}updateModalSwitchLabels(){const e=document.querySelector(".modal-switch-label.left"),n=document.querySelector(".modal-switch-label.right");if(e&&n){const t=this.currentModalMode==="verdad";e.classList.toggle("active",!t),n.classList.toggle("active",t)}}closeModal(){const e=document.getElementById("videoModal");if(e){e.classList.remove("active"),document.body.style.overflow="";const n=document.getElementById("modalVideoContainer");n&&(n.innerHTML=""),this.currentModalYear=null,this.currentModalMode=null}}initScrollProgress(){this.initTimelineScrollProgress(),window.addEventListener("scroll",()=>{this.updateTimelineCircles(),this.updateTimelineProgress()})}initTimelineScrollProgress(){document.getElementById("timeline")}updateTimelineProgress(){const e=document.getElementById("timeline"),n=document.querySelector(".verdad-mentira-section");if(!e||!n)return;n.getBoundingClientRect();const t=n.offsetTop,o=n.offsetHeight,i=window.scrollY,s=window.innerHeight,a=t,c=t+o-s;let d=0;i>=a&&i<=c?d=(i-a)/(c-a)*100:i>c&&(d=100),e.style.setProperty("--scroll-progress",`${Math.min(Math.max(d,0),100)}%`),e.classList.add("scrolling")}updateTimelineCircles(){const e=document.querySelectorAll(".timeline-item"),n=window.innerHeight;e.forEach((t,o)=>{const i=t.querySelector(".timeline-circle"),s=t.getBoundingClientRect();s.top+s.height/2<n*.7?i.classList.add("active"):i.classList.remove("active")})}initScrollAnimations(){const e=document.querySelectorAll(".timeline-item"),n=new IntersectionObserver(t=>{t.forEach(o=>{if(o.isIntersecting){o.target.style.opacity="1",o.target.style.transform="translateY(0)";const i=o.target.querySelector(".timeline-year");if(i){const a=parseInt(i.textContent);this.animateYearCounter(i,a)}const s=o.target.querySelector(".timeline-circle");s&&(document.querySelectorAll(".timeline-circle").forEach(a=>a.classList.remove("active")),s.classList.add("active"))}})},{threshold:.3,rootMargin:"0px 0px -100px 0px"});e.forEach(t=>{t.style.opacity="0",t.style.transform="translateY(50px)",t.style.transition="opacity 0.6s ease, transform 0.6s ease",n.observe(t)}),window.addEventListener("scroll",()=>{this.updateTimelineCircles()})}animateYearCounter(e,n){if(e.dataset.animating==="true")return;e.dataset.animating="true";const t=this.getPreviousYear(n);let o=t;const i=n-t;let s;i<=2?s=300:i<=10?s=150:i<=30?s=50:s=20;const a=()=>{e.textContent=o,o<n?(o++,setTimeout(a,s)):e.dataset.animating="false"};a()}getPreviousYear(e){const t=r[this.currentMode].map(i=>parseInt(i.year)).sort((i,s)=>i-s),o=t.indexOf(e);return o===0?e:t[o-1]}initParallax(){window.addEventListener("scroll",()=>{const e=window.pageYOffset,n=document.querySelector(".timeline-container");if(n){const t=n.getBoundingClientRect();if(t.top<window.innerHeight&&t.bottom>0){const o=e*.1;n.style.transform=`translateY(${o}px)`}}})}}document.readyState==="loading"?(console.log("Document still loading, waiting for DOMContentLoaded"),document.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded via event, initializing app..."),window.democraciaFakeApp=new u})):(console.log("Document already ready, initializing immediately"),setTimeout(()=>{window.democraciaFakeApp=new u},100));document.addEventListener("click",l=>{if(l.target.tagName==="A"&&l.target.getAttribute("href")?.startsWith("#")){l.preventDefault();const e=l.target.getAttribute("href").substring(1),n=document.getElementById(e);n&&n.scrollIntoView({behavior:"smooth",block:"start"})}});
