import"./style-B30AxDX6.js";const r={mentira:[{year:"1973",title:"Plan Z: la UP planea masacrar a 5 000 opositores",description:"La prensa oficial reproduce un supuesto documento militar que atribuye al gobierno de Allende un plan de autogolpe para el 19 de septiembre, con listas de enemigos y croquis de cuarteles intervenidos.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"1975",title:"Exterminados como ratones: el MIR se depura con 119 muertos",description:"El diario La Segunda afirma que los militantes desaparecidos murieron en peleas internas en el extranjero, basándose en revistas que nadie ha logrado encontrar en los países mencionados.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2017",title:"Chats de WhatsApp prueban red terrorista mapuche",description:"Capturas de pantalla presentadas por Carabineros se emiten en noticieros como prueba irrefutable de coordinación de ataques. Ocho comuneros son detenidos en horario estelar.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2018",title:"Comunero armado cae en enfrentamiento con GOPE",description:"La versión oficial acusa a Camilo Catrillanca de participar en un robo y disparar contra el GOPE. Se afirma que no hay registro audiovisual del operativo.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2020",title:"Detenido con bidón de bencina es el autor de incendio en Metro Baquedano",description:"Imágenes de un joven reducido por Carabineros se viralizan como prueba del ataque. Medios lo presentan como un manifestante violento sorprendido con acelerantes.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"},{year:"2021",title:"Fans de K-pop organizan atentados y saqueos durante protestas",description:"En redes sociales y noticieros se acusa a comunidades K-pop de usar sus plataformas para coordinar hechos de violencia durante el estallido social.",cta:"VER MENTIRA",videoUrl:"https://www.youtube.com/embed/dQw4w9WgXcQ"}],verdad:[{year:"1973",title:"Militares difunden plan sin respaldo documental ni fuentes verificables",description:"La Junta informa de un plan atribuido a la UP, pero no exhibe originales ni autores. Partidos opositores y medios extranjeros no encuentran pruebas que sustenten su existencia.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"1975",title:"Detenidos desaparecidos por razones políticas son eliminados por la DINA",description:"Organismos de derechos humanos documentan desapariciones sistemáticas de opositores. La justicia confirma que fueron víctimas del aparato represivo de la dictadura.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2017",title:"Carabineros produce montaje con capturas falsas",description:"La justicia determina que las imágenes fueron manipuladas digitalmente. Los ocho comuneros detenidos son liberados sin cargos tras demostrarse la adulteración.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2018",title:"Camilo Catrillanca muere por disparo de Carabineros sin estar armado",description:"Peritajes balísticos y testigos confirman que el comunero murió por un disparo del GOPE. No participaba en ningún robo y no portaba armas. Videos del operativo fueron destruidos.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2020",title:"Joven es detenido arbitrariamente; incendio tiene otro origen",description:"Investigaciones posteriores demuestran que el incendio tuvo causas técnicas no relacionadas con el detenido. El joven es liberado sin cargos tras comprobarse su inocencia.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"},{year:"2021",title:"Fans de K-pop apoyan causas pacíficas y derechos humanos",description:"La comunidad K-pop chilena demuestra su compromiso con la no violencia y el apoyo a manifestaciones pacíficas por la justicia social.",cta:"VER VERDAD",videoUrl:"https://www.youtube.com/embed/jNQXAC9IVRw"}]};class u{constructor(){this.currentMode="mentira",this.currentModalYear=null,this.currentModalMode="mentira",this.init()}init(){console.log("Initializing DemocraciaFake app..."),this.setupEventListeners(),this.renderTimeline(),this.initScrollAnimations(),this.updateLogo(),this.initSwitchLabels(),this.initScrollProgress(),this.initFloatingSwitch(),this.initDecadesTimeline(),this.initModalFunctionality(),window.testSwitch=e=>{console.log("Manual switch test:",e),this.toggleMode(e)},console.log("DemocraciaFake app initialized successfully"),console.log("Use window.testSwitch(true/false) to test switches manually")}initSwitchLabels(){console.log("Initializing switch labels...");const e=document.querySelector(".switch-label.left"),i=document.querySelector(".switch-label.right");console.log("Main switch labels found:",e,i),e&&i&&(e.classList.add("active"),i.classList.remove("active"));const t=document.querySelector(".floating-switch-label.left"),a=document.querySelector(".floating-switch-label.right");console.log("Floating switch labels found:",t,a),t&&a&&(t.classList.add("active"),a.classList.remove("active"))}setupEventListeners(){console.log("Setting up event listeners..."),document.addEventListener("change",o=>{console.log("Change event detected:",o.target.id,o.target.checked),o.target.id==="switchInput"?(console.log("Main switch changed via delegation:",o.target.checked),o.stopPropagation(),this.toggleMode(o.target.checked)):o.target.id==="floatingSwitchInput"?(console.log("Floating switch changed via delegation:",o.target.checked),o.stopPropagation(),this.toggleMode(o.target.checked)):o.target.id==="modalSwitchInput"&&(console.log("Modal switch changed via delegation:",o.target.checked),o.stopPropagation(),this.currentModalMode=o.target.checked?"verdad":"mentira",this.updateModalContent(),this.updateModalSwitchLabels())});const e=document.getElementById("switchInput"),i=document.getElementById("floatingSwitchInput");console.log("Switch elements check:",{mainSwitch:!!e,floatingSwitch:!!i}),document.getElementById("firmaButton")?.addEventListener("click",()=>{alert("Redirigiendo a formulario de suscripción...")}),document.addEventListener("click",o=>{if(o.target.classList.contains("timeline-cta")){o.preventDefault();const c=o.target.closest(".timeline-item").querySelector(".timeline-year").textContent;this.openVideoModal(c)}});const a=document.getElementById("videoModal"),n=document.getElementById("videoModalClose"),s=document.getElementById("videoModalOverlay");n?.addEventListener("click",()=>{this.closeModal()}),s?.addEventListener("click",()=>{this.closeModal()}),a?.addEventListener("click",o=>{o.target===a&&this.closeModal()}),document.addEventListener("keydown",o=>{o.key==="Escape"&&this.closeModal()})}toggleMode(e){console.log("toggleMode called with:",e,"current mode:",this.currentMode);const i=e?"verdad":"mentira";if(this.currentMode===i){console.log("Mode unchanged, skipping update");return}this.currentMode=i,console.log("Mode changed to:",this.currentMode),document.body.classList.toggle("verdad-mode",e);const t=document.getElementById("switchInput"),a=document.getElementById("floatingSwitchInput");t&&t.checked!==e&&(console.log("Syncing main switch to:",e),t.checked=e),a&&a.checked!==e&&(console.log("Syncing floating switch to:",e),a.checked=e),this.updateAllSwitchLabels(e),this.updateLogo(),this.renderTimeline()}updateAllSwitchLabels(e){const i=document.querySelector(".switch-label.left"),t=document.querySelector(".switch-label.right");i&&t&&(i.classList.toggle("active",!e),t.classList.toggle("active",e));const a=document.querySelector(".floating-switch-label.left"),n=document.querySelector(".floating-switch-label.right");a&&n&&(a.classList.toggle("active",!e),n.classList.toggle("active",e))}updateLogo(){const e=document.getElementById("mainLogo");e&&(this.currentMode==="verdad"?(e.src="header-verdad.png",e.alt="Democracia Fake - Verdad"):(e.src="header-mentira.png",e.alt="Democracia Fake - Montaje"))}renderTimeline(){const e=document.getElementById("timeline");if(!e)return;const i=r[this.currentMode];e.innerHTML="",i.forEach((t,a)=>{const n=document.createElement("div");n.className="timeline-item",n.setAttribute("data-year",t.year),n.innerHTML=`
        <div class="timeline-circle ${a===0?"active":""}"></div>
        <div class="timeline-year">${t.year}</div>
        <div class="timeline-content">
          <h3>${t.title}</h3>
          <p>${t.description}</p>
          <button class="timeline-cta">${t.cta}</button>
        </div>
      `,e.appendChild(n)}),this.initScrollAnimations()}initFloatingSwitch(){const e=document.getElementById("floatingSwitchNav");if(!e){console.error("Floating switch nav element not found");return}window.addEventListener("scroll",()=>{const i=window.scrollY,t=document.querySelector(".verdad-mentira-section");if(t){const a=t.offsetTop;i>=a-200?e.classList.add("visible"):e.classList.remove("visible")}})}initDecadesTimeline(){const e=document.querySelector(".decades-items");if(!e)return;const i=[{decade:1970,label:"70s",years:["1973","1975"]},{decade:1980,label:"80s",years:[]},{decade:1990,label:"90s",years:[]},{decade:2e3,label:"00s",years:[]},{decade:2010,label:"10s",years:["2017","2018"]},{decade:2020,label:"20s",years:["2020","2021"]}];e.innerHTML="",i.forEach((t,a)=>{const n=document.createElement("div");n.className="decade-item",n.setAttribute("data-decade",t.decade),t.years.length===0&&n.classList.add("no-content");const s=document.createElement("div");s.className=`decade-circle ${a===0?"active":""}`;const o=document.createElement("div");o.className="decade-label",o.textContent=t.label,n.appendChild(s),n.appendChild(o),t.years.length>0?(n.addEventListener("click",()=>{this.scrollToDecade(t.decade,t.years[0]),document.querySelectorAll(".decade-circle").forEach(c=>c.classList.remove("active")),s.classList.add("active")}),n.style.cursor="pointer"):(n.style.cursor="not-allowed",n.style.opacity="0.5"),e.appendChild(n)}),this.initDecadesTimelineVisibility(),window.addEventListener("scroll",()=>{this.updateDecadesTimeline()})}initDecadesTimelineVisibility(){const e=document.querySelector(".decades-timeline"),i=document.querySelector(".verdad-mentira-section");!e||!i||window.addEventListener("scroll",()=>{const t=i.offsetTop;window.scrollY>=t-100?e.classList.add("visible"):e.classList.remove("visible")})}scrollToDecade(e,i){const t=document.querySelector(`[data-year="${i}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"center"})}updateDecadesTimeline(){const e=document.querySelectorAll(".decade-item"),i=document.querySelectorAll(".timeline-item"),t=window.innerHeight;let a=null;i.forEach(n=>{const s=n.getBoundingClientRect(),o=parseInt(n.getAttribute("data-year"));s.top<t*.6&&s.bottom>t*.4&&(o>=1970&&o<1980?a=1970:o>=2010&&o<2020?a=2010:o>=2020&&o<2030&&(a=2020))}),e.forEach(n=>{const s=parseInt(n.getAttribute("data-decade")),o=n.querySelector(".decade-circle");s===a?o.classList.add("active"):o.classList.remove("active")})}initModalFunctionality(){const e=document.getElementById("modalSwitchInput");e&&(e.checked=!1)}openVideoModal(e){console.log("Opening video modal for year:",e),this.currentModalYear=e,this.currentModalMode=this.currentMode;const i=document.getElementById("videoModal"),t=document.getElementById("modalSwitchInput");this.updateModalContent(),t?(console.log("Modal switch found, setting checked state"),t.checked=this.currentModalMode==="verdad"):console.error("Modal switch not found"),this.updateModalSwitchLabels(),i&&(i.classList.add("active"),document.body.style.overflow="hidden")}updateModalContent(){const e=this.currentModalYear,i=this.currentModalMode,t=r.mentira.findIndex(o=>o.year===e);if(t===-1)return;const a=r[i][t],n=document.getElementById("modalTitle");n&&(n.textContent=`${e} - ${a.title}`);const s=document.getElementById("modalVideoContainer");s&&a.videoUrl&&(s.innerHTML=`
        <iframe 
          src="${a.videoUrl}" 
          frameborder="0" 
          allowfullscreen>
        </iframe>
      `)}updateModalSwitchLabels(){const e=document.querySelector(".modal-switch-label.left"),i=document.querySelector(".modal-switch-label.right");if(e&&i){const t=this.currentModalMode==="verdad";e.classList.toggle("active",!t),i.classList.toggle("active",t)}}closeModal(){const e=document.getElementById("videoModal");if(e){e.classList.remove("active"),document.body.style.overflow="";const i=document.getElementById("modalVideoContainer");i&&(i.innerHTML=""),this.currentModalYear=null,this.currentModalMode=null}}initScrollProgress(){this.initTimelineScrollProgress(),window.addEventListener("scroll",()=>{this.updateTimelineCircles(),this.updateTimelineProgress()})}initTimelineScrollProgress(){document.getElementById("timeline")}updateTimelineProgress(){const e=document.getElementById("timeline"),i=document.querySelector(".verdad-mentira-section");if(!e||!i)return;i.getBoundingClientRect();const t=i.offsetTop,a=i.offsetHeight,n=window.scrollY,s=window.innerHeight,o=t,c=t+a-s;let d=0;n>=o&&n<=c?d=(n-o)/(c-o)*100:n>c&&(d=100),e.style.setProperty("--scroll-progress",`${Math.min(Math.max(d,0),100)}%`),e.classList.add("scrolling")}updateTimelineCircles(){const e=document.querySelectorAll(".timeline-item"),i=window.innerHeight;e.forEach((t,a)=>{const n=t.querySelector(".timeline-circle"),s=t.getBoundingClientRect();s.top+s.height/2<i*.7?n.classList.add("active"):n.classList.remove("active")})}initScrollAnimations(){const e=document.querySelectorAll(".timeline-item"),i=new IntersectionObserver(t=>{t.forEach(a=>{if(a.isIntersecting){a.target.style.opacity="1",a.target.style.transform="translateY(0)";const n=a.target.querySelector(".timeline-year");if(n){const o=parseInt(n.textContent);this.animateYearCounter(n,o)}const s=a.target.querySelector(".timeline-circle");s&&(document.querySelectorAll(".timeline-circle").forEach(o=>o.classList.remove("active")),s.classList.add("active"))}})},{threshold:.3,rootMargin:"0px 0px -100px 0px"});e.forEach(t=>{t.style.opacity="0",t.style.transform="translateY(50px)",t.style.transition="opacity 0.6s ease, transform 0.6s ease",i.observe(t)}),window.addEventListener("scroll",()=>{this.updateTimelineCircles()})}animateYearCounter(e,i){if(e.dataset.animating==="true")return;e.dataset.animating="true";const t=this.getPreviousYear(i);let a=t;const n=i-t;let s;n<=2?s=300:n<=10?s=150:n<=30?s=50:s=20;const o=()=>{e.textContent=a,a<i?(a++,setTimeout(o,s)):e.dataset.animating="false"};o()}getPreviousYear(e){const t=r[this.currentMode].map(n=>parseInt(n.year)).sort((n,s)=>n-s),a=t.indexOf(e);return a===0?e:t[a-1]}initParallax(){window.addEventListener("scroll",()=>{const e=window.pageYOffset,i=document.querySelector(".timeline-container");if(i){const t=i.getBoundingClientRect();if(t.top<window.innerHeight&&t.bottom>0){const a=e*.1;i.style.transform=`translateY(${a}px)`}}})}}document.readyState==="loading"?(console.log("Document still loading, waiting for DOMContentLoaded"),document.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded via event, initializing app..."),window.democraciaFakeApp=new u})):(console.log("Document already ready, initializing immediately"),setTimeout(()=>{window.democraciaFakeApp=new u},100));document.addEventListener("click",l=>{if(l.target.tagName==="A"&&l.target.getAttribute("href")?.startsWith("#")){l.preventDefault();const e=l.target.getAttribute("href").substring(1),i=document.getElementById(e);i&&i.scrollIntoView({behavior:"smooth",block:"start"})}});
